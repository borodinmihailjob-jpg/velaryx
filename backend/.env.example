# ============================================================
# AstroBot Backend — Environment Variables Reference
# Copy this file to .env (dev) or .env.prod (prod) and fill in.
# Lines starting with # are comments and are not read by the app.
# ============================================================

# ── App environment ──────────────────────────────────────────
APP_ENV=development                     # "development" | "production"
LOCAL_ONLY_MODE=false                   # true = offline mode, no external API calls

# ── Database ─────────────────────────────────────────────────
DATABASE_URL=postgresql://user:password@localhost:5432/astrobot
# For local SQLite dev:
# DATABASE_URL=sqlite:///./astrobot.db

POSTGRES_DB=astrobot
POSTGRES_USER=user
POSTGRES_PASSWORD=changeme              # Required — pick a strong password

# ── Redis (required for ARQ task queue) ──────────────────────
REDIS_URL=redis://localhost:6379/0
# In Docker Compose: redis://redis:6379/0

# ── Telegram Bot ─────────────────────────────────────────────
BOT_TOKEN=                              # Required in production — get from @BotFather
BOT_USERNAME=replace_me_bot            # Your bot's username without @
MINI_APP_NAME=app                       # Mini App shortname in BotFather
MINI_APP_PUBLIC_BASE_URL=              # Full HTTPS URL of deployed miniapp (e.g. https://example.com)

# ── Authentication ────────────────────────────────────────────
# CRITICAL: keep ALLOW_INSECURE_DEV_AUTH=false in production.
# When true, any X-TG-USER-ID header is trusted without InitData verification.
ALLOW_INSECURE_DEV_AUTH=false

REQUIRE_TELEGRAM_INIT_DATA=false       # true = enforce Telegram InitData HMAC check
TELEGRAM_INIT_DATA_MAX_AGE_SECONDS=900 # Max age of InitData before rejection (15 min)

# Internal service-to-service API key (bot → api calls)
# Generate with: python -c "import secrets; print(secrets.token_hex(32))"
INTERNAL_API_KEY=

# ── CORS ─────────────────────────────────────────────────────
# Comma-separated list of allowed origins. Leave empty to block all cross-origin.
CORS_ORIGINS_RAW=https://your-miniapp-domain.com

# ── Ollama (local LLM runtime) ────────────────────────────────
OLLAMA_BASE_URL=http://host.docker.internal:11434
# In Docker Compose: http://ollama:11434
OLLAMA_MODEL=qwen2.5:7b
OLLAMA_TIMEOUT_SECONDS=60.0

# ── Astrology provider ────────────────────────────────────────
# "swisseph" = local Swiss Ephemeris (default, no API key required)
# "astrologyapi" = external provider with local fallback
ASTROLOGY_PROVIDER=swisseph
ASTROLOGY_EPHE_PATH=                   # Path to ephemeris files (optional override)

# AstrologyAPI.com credentials (only needed if ASTROLOGY_PROVIDER=astrologyapi)
ASTROLOGYAPI_USER_ID=
ASTROLOGYAPI_API_KEY=
ASTROLOGYAPI_HOUSE_SYSTEM=placidus
ASTROLOGYAPI_TIMEOUT_SECONDS=15.0

# ── Tarot provider ────────────────────────────────────────────
# "local" = built-in deck (default)
# "tarotapi_dev" = external text meanings + local fallback
TAROT_PROVIDER=local
TAROTAPI_TIMEOUT_SECONDS=10.0
TAROT_IMAGE_BASE_URL=https://raw.githubusercontent.com/metabismuth/tarot-json/master/cards

# ── Localization / Translation ────────────────────────────────
ENABLE_RESPONSE_LOCALIZATION=true      # Localize LLM responses to Russian
TRANSLATE_VIA_GOOGLE_FREE=true         # Use Google Translate unofficial API
TRANSLATION_TIMEOUT_SECONDS=8.0

# ── Vite / Frontend build args (for docker-compose.prod.yml) ──
VITE_BOT_USERNAME=replace_me_bot
VITE_APP_NAME=app
VITE_API_BASE_URL=/api
VITE_ALLOW_DEV_AUTH=false
VITE_TAROT_LOADING_GIF=/tarot-loader.gif
VITE_NATAL_LOADING_GIF=/natal-loader.gif
